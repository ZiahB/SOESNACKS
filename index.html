<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SOESNACKS Register</title>
  <link href="https://fonts.googleapis.com/css2?family=Comic+Neue:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles/style.css" />
</head>
<body>
  <header>
    🍬 SOESNACKS Register
    <span>Powered by <strong>Scholars of Excellence</strong></span>
  </header>

  <div class="register-container">
    <h2>Tap a Snack to Add to Your Order!</h2>
    <div id="menu-sections">
      <!-- Sections will be generated by JS -->
    </div>

    <h3>Current Order</h3>
    <ul id="order-list"></ul>
    <p class="total-display"><strong>Total:</strong> $<span id="order-total">0.00</span></p>

    <button class="btn-action" onclick="completeSale()">🎉 Complete Sale</button>

    <div class="summary">
      <h3>Today's Snack Shack Summary</h3>
      <p><strong>Total Sales:</strong> $<span id="daily-sales">0.00</span></p>
      <p><strong>Orders Completed:</strong> <span id="order-count">0</span></p>
      <p><strong>Money Made Today:</strong> $<span id="money-made">0.00</span></p>
      <h4>Items Sold:</h4>
      <ul id="items-sold-list"></ul>
      <button class="btn-reset" onclick="resetSales()">🔄 Reset Day</button>
    </div>
  </div>

  <footer>
    © 2025 <strong>SOESNACKS</strong> | A Sweet Project by <strong>Scholars of Excellence</strong>
    <br />
    <small style="color:#aaa; font-size:0.9em;">Website made by <strong>Keziah Bester</strong> 🍭</small>
  </footer>

  <!-- Centered Pop-up Modal -->
  <div id="popup" class="modal">
    <div class="modal-content">
      <h3>🎉 Sale Completed!</h3>
      <p>Amount Due: $<span id="popup-total"></span></p>
      <button class="btn-action" onclick="closePopup()">OK</button>
    </div>
  </div>

  <canvas id="confetti-canvas"></canvas>

  <script>
    // Updated menu with sections and items
    const menuSections = [
      {
        title: "Chips",
        items: [
          { name: "Walking Taco", emoji: "🌮", price: 6.00 },
          { name: "Chips and Meat", emoji: "🍖", price: 4.00 },
          { name: "Chips and Cheese", emoji: "🧀", price: 2.00 },
          { name: "Chips", emoji: "🍟", price: 1.00 }
        ]
      },
      {
        title: "Candy ($2.50 each)",
        items: [
          { name: "Skittles", emoji: "🌈", price: 2.50 },
          { name: "Starburst", emoji: "⭐", price: 2.50 },
          { name: "Swedish Fish", emoji: "🐟", price: 2.50 },
          { name: "Sour Patch Kids", emoji: "😝", price: 2.50 },
          { name: "Air Head Extremes", emoji: "🌀", price: 2.50 }
        ]
      },
      {
        title: "Sweet Treats",
        items: [
          { name: "Honey Bun", emoji: "🍯", price: 2.00 },
          { name: "Cosmic Brownie", emoji: "🍫", price: 2.00 },
          { name: "Blow Pop", emoji: "🍭", price: 0.50 }
        ]
      },
      {
        title: "Drinks",
        items: [
          { name: "Minute Maid", emoji: "🍹", price: 2.00 },
          { name: "Gatorade", emoji: "🏃‍♂️", price: 2.00 },
          { name: "MSCR Juice", emoji: "🧃", price: 2.00 },
          { name: "Capri Sun", emoji: "☀️", price: 2.00 },
          { name: "Water", emoji: "💧", price: 1.00 },
          { name: "Can Sodas", emoji: "🥤", price: 2.50 }
        ]
      }
    ];

    const menuContainer = document.getElementById("menu-sections");
    const orderList = document.getElementById("order-list");
    const orderTotalDisplay = document.getElementById("order-total");
    const dailySalesDisplay = document.getElementById("daily-sales");
    const orderCountDisplay = document.getElementById("order-count");
    const moneyMadeDisplay = document.getElementById("money-made");
    const itemsSoldList = document.getElementById("items-sold-list");

    let order = [];
    let dailySales = parseFloat(localStorage.getItem("dailySales")) || 0;
    let orderCount = parseInt(localStorage.getItem("orderCount")) || 0;
    let moneyMade = parseFloat(localStorage.getItem("moneyMade")) || 0;
    // Track how many sold per item by name
    let itemsSold = JSON.parse(localStorage.getItem("itemsSold")) || {};

    updateSummary();

    // Build menu sections and buttons with emoji on top
    menuSections.forEach((section) => {
      const sectionDiv = document.createElement("div");
      sectionDiv.className = "menu-section";

      const h3 = document.createElement("h3");
      h3.textContent = section.title;
      sectionDiv.appendChild(h3);

      const buttonsDiv = document.createElement("div");
      buttonsDiv.className = "section-buttons";

      section.items.forEach((item) => {
        const btn = document.createElement("button");
        btn.className = "item-btn";
        btn.innerHTML = `
          <div class="emoji">${item.emoji}</div>
          <div class="item-name">${item.name}</div>
          <div class="price">$${item.price.toFixed(2)}</div>
        `;
        btn.onclick = () => addToOrder(item);
        buttonsDiv.appendChild(btn);
      });

      sectionDiv.appendChild(buttonsDiv);
      menuContainer.appendChild(sectionDiv);
    });

    function addToOrder(item) {
      order.push(item);
      updateOrder();
    }

    function updateOrder() {
      orderList.innerHTML = "";
      let total = 0;
      order.forEach((item, i) => {
        total += item.price;
        const li = document.createElement("li");
        li.innerHTML = `
          <span>${item.emoji} ${item.name} — $${item.price.toFixed(2)}</span>
          <button class="remove-btn" onclick="removeItem(${i})">x</button>
        `;
        orderList.appendChild(li);
      });
      orderTotalDisplay.textContent = total.toFixed(2);
    }

    function removeItem(index) {
      order.splice(index, 1);
      updateOrder();
    }

    function completeSale() {
      const total = parseFloat(orderTotalDisplay.textContent);
      if (order.length === 0) {
        alert("No snacks in your order!");
        return;
      }
      dailySales += total;
      moneyMade += total;
      orderCount++;

      // Update items sold count
      order.forEach((item) => {
        itemsSold[item.name] = (itemsSold[item.name] || 0) + 1;
      });

      // Save to localStorage
      localStorage.setItem("dailySales", dailySales.toFixed(2));
      localStorage.setItem("orderCount", orderCount);
      localStorage.setItem("moneyMade", moneyMade.toFixed(2));
      localStorage.setItem("itemsSold", JSON.stringify(itemsSold));

      document.getElementById("popup-total").textContent = total.toFixed(2);
      document.getElementById("popup").style.display = "flex";
      startConfetti();

      order = [];
      updateOrder();
      updateSummary();
    }

    function closePopup() {
      document.getElementById("popup").style.display = "none";
    }

    function updateSummary() {
      dailySalesDisplay.textContent = dailySales.toFixed(2);
      orderCountDisplay.textContent = orderCount;
      moneyMadeDisplay.textContent = moneyMade.toFixed(2);

      // Update items sold list
      itemsSoldList.innerHTML = "";
      for (const [itemName, count] of Object.entries(itemsSold)) {
        const li = document.createElement("li");
        li.textContent = `${itemName}: ${count}`;
        itemsSoldList.appendChild(li);
      }
    }

    function resetSales() {
      if (confirm("Reset all daily data?")) {
        dailySales = 0;
        orderCount = 0;
        moneyMade = 0;
        itemsSold = {};

        localStorage.setItem("dailySales", 0);
        localStorage.setItem("orderCount", 0);
        localStorage.setItem("moneyMade", 0);
        localStorage.setItem("itemsSold", JSON.stringify({}));

        updateSummary();
      }
    }

    // Confetti animation (same as before)
    const confettiCanvas = document.getElementById("confetti-canvas");
    const ctx = confettiCanvas.getContext("2d");
    confettiCanvas.width = window.innerWidth;
    confettiCanvas.height = window.innerHeight;
    let confetti = [];

    function startConfetti() {
      confetti = Array.from({ length: 100 }, () => ({
        x: Math.random() * confettiCanvas.width,
        y: Math.random() * confettiCanvas.height - confettiCanvas.height,
        size: Math.random() * 8 + 3,
        color: `hsl(${Math.random() * 360}, 80%, 60%)`,
        speed: Math.random() * 3 + 2,
      }));
      animateConfetti();
      setTimeout(() => (confetti = []), 3000);
    }

    function animateConfetti() {
      ctx.clearRect(0, 0, confettiCanvas.width, confettiCanvas.height);
      confetti.forEach((p) => {
        ctx.beginPath();
        ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
        ctx.fillStyle = p.color;
        ctx.fill();
        p.y += p.speed;
        if (p.y > confettiCanvas.height) p.y = 0;
      });
      if (confetti.length > 0) requestAnimationFrame(animateConfetti);
    }

    window.addEventListener("resize", () => {
      confettiCanvas.width = window.innerWidth;
      confettiCanvas.height = window.innerHeight;
    });
  </script>
</body>
</html>
